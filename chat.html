<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Àríyọ̀ AI Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            transition: background 0.3s ease-in-out;
        }
        .chat-container {
            width: 100vw;
            height: 100dvh;
            display: none; /* Initially hidden */
            justify-content: center;
            align-items: center;
            background: #111;
            transition: height 0.3s ease-in-out;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .button {
            position: fixed;
            right: 15px;
            background: linear-gradient(135deg, #ff7e5f, #feb47b);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            z-index: 10;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
            transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
        }
        .button:hover {
            background: linear-gradient(135deg, #feb47b, #ff7e5f);
            transform: scale(1.1);
            box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.4);
        }
        .close-button { top: 15px; }
        .mute-button { top: 65px; }

        @media screen and (max-width: 768px) {
            .chat-container, iframe { height: 100dvh; }
        }
    </style>
</head>
<body>
    <!-- Button to open the chat -->
    <button class="button" onclick="openChat()" aria-label="Open chat"><i class="fa-solid fa-comments"></i></button>
    
    <!-- Chat container (hidden by default) -->
    <div class="chat-container" id="chatContainer">
        <iframe id="chatbot" src="https://interfaces.zapier.com/embed/chatbot/cm7s2oyu2000b3vmuwcwkj9kn" title="Àríyọ̀ AI Chat"></iframe>
    </div>

    <!-- Music player (hidden by default, auto-started when the page is opened) -->
    <audio id="musicPlayer" controls style="display:none;" loop autoplay>
        <source id="trackSource" src="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Emergency.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <!-- Track Selector Dropdown (Optional for users to pick a track) -->
    <select id="trackSelector" onchange="changeTrack()">
        <option value="Emergency.mp3">Emergency</option>
        <option value="A%20Very%20Good%20Bad%20Guy%20v3.mp3">A Very Good Bad Guy v3</option>
        <option value="Dem%20Wan%20Shut%20Me%20Up.mp3">Dem Wan Shut Me Up</option>
        <option value="EFCC.mp3">EFCC</option>
        <option value="Film%20Trick%20Election.mp3">Film Trick Election</option>
        <option value="Gbas%20Gbos.mp3">Gbas Gbos</option>
        <option value="Kindness%20(Remastered).mp3">Kindness (Remastered)</option>
        <option value="Locked%20Away.mp3">Locked Away</option>
        <option value="Multi%20choice%20palava.mp3">Multi choice palav</option>
        <option value="Na%20My%20Turn.mp3">Na My Turn</option>
        <option value="Ogoni%20Anthem%20(Remastered).mp3">Ogoni Anthem (Remastered)</option>
        <option value="Ogoni%20Anthem.mp3">Ogoni Anthem</option>
        <option value="Rich%20Pauper.mp3">Rich Pauper</option>
        <option value="Senator%20Natasha’s%20Whisper.mp3">Senator Natasha’s Whisper</option>
        <option value="Sharing%20Formula.mp3">Sharing Formula</option>
    </select>

    <!-- Close button for the chat -->
    <button class="button close-button" onclick="closeChat()" aria-label="Close chat"><i class="fa-solid fa-xmark"></i></button>
    <button class="button mute-button" id="muteButton" onclick="toggleMute()" aria-label="Mute or unmute music"><i class="fa-solid fa-volume-high"></i></button>

    <script>
        let isMuted = false;
        const tracks = [
            "Emergency.mp3",
            "A Very Good Bad Guy v3.mp3",
            "Dem Wan Shut Me Up.mp3",
            "EFCC.mp3",
            "Film Trick Election.mp3",
            "Gbas Gbos.mp3",
            "Kindness (Remastered).mp3",
            "Locked Away.mp3",
            "Multi choice palav.mp3",
            "Na My Turn.mp3",
            "Ogoni Anthem (Remastered).mp3",
            "Ogoni Anthem.mp3",
            "Rich Pauper.mp3",
            "Senator Natasha’s Whisper.mp3",
            "Sharing Formula.mp3"
        ];

        // Function to randomly shuffle the tracks array
        function shuffleTracks() {
            for (let i = tracks.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [tracks[i], tracks[j]] = [tracks[j], tracks[i]]; // Swap the elements
            }
        }

        // Play the next random track after the current one ends
        document.getElementById('musicPlayer').addEventListener('ended', function() {
            shuffleTracks(); // Shuffle tracks before playing the next one
            playRandomTrack();
        });

        // Function to play a random track from the shuffled list
        function playRandomTrack() {
            const trackName = tracks[0]; // Get the first track from the shuffled array
            const trackURL = `https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/${trackName}`;
            const musicPlayer = document.getElementById("musicPlayer");
            const trackSource = document.getElementById("trackSource");

            trackSource.src = trackURL;
            musicPlayer.load(); // Reload the audio element with the new track
            musicPlayer.play(); // Play the new track
        }

        // Open the chat container
        function openChat() {
            console.log("Open chat clicked"); // Debugging line
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.style.display = 'flex'; // Show the chat container
            document.querySelector('.button').style.display = 'none'; // Hide open button after clicking
            localStorage.setItem('chatClosed', 'false');
        }

        // Close the chat container
        function closeChat() {
            console.log("Close chat clicked"); // Debugging line
            document.getElementById('chatContainer').style.display = 'none';
            document.querySelector('.button').style.display = 'block'; // Show open button when chat is closed
            localStorage.setItem('chatClosed', 'true');
        }

        // Toggle mute functionality
        function toggleMute() {
            const muteButton = document.getElementById("muteButton");
            const musicPlayer = document.getElementById("musicPlayer");
            if (isMuted) {
                musicPlayer.play(); // Resume playing when unmuted
                muteButton.innerHTML = '<i class="fa-solid fa-volume-high"></i>';
            } else {
                musicPlayer.pause(); // Pause when muted
                muteButton.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
            }
            isMuted = !isMuted;
        }

        // Start with a shuffled track when the page is loaded
        window.onload = function() {
            shuffleTracks(); // Shuffle the tracks when the page loads
            playRandomTrack(); // Play the first random track
            if (localStorage.getItem('chatClosed') === 'true') {
                document.getElementById('chatContainer').style.display = 'none';
            }
        }
    </script>
</body>
</html>
