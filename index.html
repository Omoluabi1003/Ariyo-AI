<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
 <meta name="apple-mobile-web-app-capable" content="yes" />
 <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
 <meta name="theme-color" content="#ff758c" />
 <meta name="description" content="Àríyò AI - A street-smart Nigerian AI by Omoluabi Productions offering music, radio, and chatbot features." />
 <meta name="keywords" content="Àríyò AI, Naija AI, Omoluabi, Nigerian music, AI chatbot" />
 <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
 <meta http-equiv="Pragma" content="no-cache" />
 <meta http-equiv="Expires" content="0" />
 <title>Àríyò AI - Smart Naija AI</title>
 <link rel="preconnect" href="https://fonts.googleapis.com" />
 <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
 <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
 <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js" integrity="sha512-GWzVrcGlo0TxTRvz9ttioyYJ+Wwk9Ck0G81D+eO63BaqHaJ3YZX9wuqjwgfcV/MrB2PhaVX9DkYVhbFzONWFxfg==" crossorigin="anonymous" defer></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js" integrity="sha512-16esztaSRplJROstbIIdwX3N97V1+pZvV33ABoG1H2OyTttBxEGkTsoIVsiP1iaTtM8b3+hu2kB6pQ4Clr5yug==" crossorigin="anonymous" defer></script>
 <script async type="module" src="https://interfaces.zapier.com/assets/web-components/zapier-interfaces/zapier-interfaces.esm.js" onerror="console.warn('Zapier script failed to load')"></script>
 <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
 <link rel="icon" type="image/png" sizes="192x192" href="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ariyo-192x192.png">
 <link rel="icon" type="image/png" sizes="180x180" href="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ariyo-180x180.png">
 <link rel="icon" type="image/png" sizes="512x512" href="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ariyo-512x512.png">
 <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ariyo-180x180.png">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { height: 100%; overflow-x: hidden; background-color: #000; }
  body {
   font-family: 'Montserrat', sans-serif;
   color: #fff;
   display: flex;
   flex-direction: column;
   min-height: 100vh;
   background-size: cover;
   background-position: center;
   transition: background 0.5s ease-in-out, color 0.5s ease-in-out;
   padding-top: env(safe-area-inset-top);
   padding-bottom: env(safe-area-inset-bottom);
   will-change: background-image;
  }
  a { text-decoration: none; }
  .dark-mode { background-color: #121212; color: #ffffff; }
  .header {
   padding: calc(1rem + env(safe-area-inset-top)) 1rem 1rem;
   text-align: center;
   font-size: clamp(1.5rem, 4vw, 2rem);
   font-weight: bold;
   background: linear-gradient(to right, #ff758c, #ff7eb3);
   box-shadow: 0px 5px 10px rgba(0,0,0,0.2);
   position: relative;
   z-index: 1000;
  }
  .share-button {
   position: absolute;
   top: calc(0.5rem + env(safe-area-inset-top));
   right: 0.5rem;
   background: transparent;
   border: none;
   cursor: pointer;
   padding: 0.5rem;
   transition: transform 0.3s ease;
  }
  .share-button:hover { transform: scale(1.1); }
  .share-button svg {
   width: 24px;
   height: 24px;
   fill: #fff;
   filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }
  .container { 
   flex: 1; 
   display: flex; 
   flex-direction: row; 
   overflow: hidden; 
   overflow-y: auto;
   height: calc(100vh - 60px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
   position: relative;
  }
  .sidebar {
   width: 250px;
   background: rgba(34, 34, 34, 0.9);
   backdrop-filter: blur(10px);
   display: flex;
   flex-direction: column;
   align-items: center;
   padding: 1rem;
   gap: 1rem;
   border-radius: 15px;
   box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.3);
   flex-shrink: 0;
   z-index: 100;
   position: sticky;
   top: 0;
  }
  .sidebar button {
   background: linear-gradient(135deg, #ff7eb3, #ff758c);
   color: #fff;
   padding: 0.8rem 1rem;
   border: none;
   border-radius: 25px;
   width: 90%;
   cursor: pointer;
   font-size: clamp(0.9rem, 2vw, 1rem);
   transition: all 0.3s ease-in-out;
   display: flex;
   align-items: center;
   justify-content: center;
   gap: 0.5rem;
   min-height: 48px;
  }
  .sidebar button:hover { transform: scale(1.08); box-shadow: 0px 4px 10px rgba(255, 117, 140, 0.6); }
  .sidebar button:focus { outline: 2px solid #ff4060; outline-offset: 2px; }
  .content { 
   flex: 1; 
   padding: 1.5rem; 
   overflow-y: auto; 
   opacity: 0; 
   transition: opacity 0.5s ease-in-out;
   min-height: 200px;
  }
  .music-player {
   background: linear-gradient(135deg, rgba(34, 34, 34, 0.7), rgba(18, 18, 18, 0.9));
   padding: 1rem;
   text-align: center;
   border-radius: 10px;
   box-shadow: 0px 5px 15px rgba(0,0,0,0.3);
   position: fixed;
   bottom: calc(2rem + env(safe-area-inset-bottom));
   width: 100%;
   max-width: 600px;
   left: 50%;
   transform: translateX(-50%);
   z-index: 100;
  }
  .album-cover {
   width: clamp(120px, 30vw, 200px);
   height: clamp(120px, 30vw, 200px);
   border-radius: 50%;
   margin: 0.6rem auto;
   display: block;
   box-shadow: 0px 4px 15px rgba(255,255,255,0.3);
   transition: transform 0.3s ease-in-out, opacity 0.3s ease;
  }
  .spin { animation: spin 3s linear infinite; }
  @keyframes spin {
   0% { transform: rotate(0deg); }
   100% { transform: rotate(360deg); }
  }
  .loading-spinner {
   display: none;
   width: 30px;
   height: 30px;
   border: 4px solid #fff;
   border-top: 4px solid #ff758c;
   border-radius: 50%;
   animation: spin 1s linear infinite;
   margin: 0 auto;
   transition: opacity 0.3s ease;
  }
  .music-controls.icons-only {
   margin-top: 0.6rem;
   display: flex;
   justify-content: center;
   align-items: center;
   flex-wrap: wrap;
   gap: 0.6rem;
  }
  .music-controls.icons-only button {
   background: #ff758c;
   color: white;
   border: none;
   padding: 1rem;
   border-radius: 25px;
   cursor: pointer;
   font-size: 1.2rem;
   transition: transform 0.2s;
   min-width: 56px;
   min-height: 56px;
  }
  .music-controls.icons-only button:hover { transform: scale(1.1); }
  .track-info { margin-top: 0.6rem; font-size: clamp(1rem, 3vw, 1.2rem); }
  .track-duration { font-size: clamp(0.8rem, 2vw, 0.9rem); margin-top: 0.3rem; }
  .track-details { margin-top: 0.6rem; font-size: clamp(0.8rem, 2vw, 0.9rem); }
  #streakInfo { color: #ff0000; }
  .dropdown {
   width: 100%;
   background: rgba(34,34,34,0.8);
   color: white;
   padding: 0.6rem;
   border-radius: 5px;
   cursor: pointer;
   text-align: center;
   margin-top: 1rem;
   font-size: clamp(0.9rem, 2vw, 1rem);
  }
  .modal {
   display: none;
   position: fixed;
   z-index: 1000;
   left: 0;
   top: 0;
   width: 100%;
   height: 100%;
   overflow: auto;
   background-color: rgba(0,0,0,0.4);
  }
  .modal-content {
   background-color: #ffffff;
   margin: 10% auto;
   padding: 1.5rem;
   border: 1px solid #888;
   width: 90%;
   max-width: 600px;
   max-height: 80vh;
   overflow-y: auto;
   border-radius: 10px;
   color: #000;
   position: relative;
  }
  .close {
   position: absolute;
   top: 10px;
   right: 10px;
   width: 20px;
   height: 20px;
   background: red;
   border-radius: 50%;
   color: transparent;
   font-size: 0;
   cursor: pointer;
  }
  .track-list a, .album-list a, .radio-list a {
   display: block;
   padding: 0.8rem;
   color: #000;
   text-decoration: none;
   background-color: #f0f0f0;
   margin-bottom: 0.3rem;
   border-radius: 5px;
   font-size: clamp(0.9rem, 2vw, 1rem);
  }
  .track-list a:hover, .album-list a:hover, .radio-list a:hover { background-color: #ff758c; color: #fff; }
  .chatbot-container, .sabi-bible-container {
   position: fixed;
   bottom: calc(100px + env(safe-area-inset-bottom));
   left: 50%;
   transform: translateX(-50%);
   width: 90%;
   max-width: 600px;
   height: 70vh;
   border-radius: 10px;
   box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
   background: white;
   overflow: hidden;
   display: none;
   z-index: 2000;
  }
  .chatbot-container.active, .sabi-bible-container.active {
   display: block;
  }
  .chatbot-container zapier-interfaces-chatbot-embed, 
  .sabi-bible-container zapier-interfaces-chatbot-embed {
   width: 100%;
   height: 100%;
   border: none;
   border-radius: 10px;
  }
  .popup-close {
   position: absolute;
   top: 10px;
   right: 10px;
   width: 24px;
   height: 24px;
   background: #ff758c;
   color: white;
   border: none;
   border-radius: 50%;
   font-size: 1rem;
   line-height: 24px;
   text-align: center;
   cursor: pointer;
   z-index: 2020;
  }
  .popup-close:hover { background: #ff4060; }
  .chatbot-bubble-container {
   position: fixed;
   bottom: calc(80px + env(safe-area-inset-bottom));
   left: 1rem;
   width: clamp(60px, 15vw, 70px);
   height: clamp(60px, 15vw, 70px);
   cursor: pointer;
   z-index: 1500;
   display: flex;
   align-items: flex-end;
   justify-content: center;
   transition: transform 0.3s ease;
  }
  .sabi-bible-bubble-container {
   position: fixed;
   bottom: calc(80px + env(safe-area-inset-bottom));
   right: 1rem;
   width: clamp(60px, 15vw, 70px);
   height: clamp(60px, 15vw, 70px);
   cursor: pointer;
   z-index: 1500;
   display: flex;
   align-items: flex-end;
   justify-content: center;
   transition: transform 0.3s ease;
  }
  .chatbot-bubble-container:hover, .sabi-bible-bubble-container:hover { transform: scale(1.1); }
  .chatbot-float-icon, .sabi-bible-float-icon {
   width: 100%;
   height: 100%;
   border-radius: 50%;
   box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
   animation: float 3s ease-in-out infinite;
  }
  @keyframes float {
   0% { transform: translateY(0px); }
   50% { transform: translateY(-10px); }
   100% { transform: translateY(0px); }
  }
  .chatbot-speech-bubble, .sabi-bible-speech-bubble {
   position: absolute;
   bottom: 100%;
   left: 50%;
   transform: translateX(-50%);
   background: #ffffff;
   color: #000000;
   border: 3px solid #000000;
   border-radius: 15px;
   font-family: "Comic Sans MS", "Chalkboard SE", sans-serif;
   font-size: clamp(0.8rem, 2vw, 0.9rem);
   padding: 0.6rem 1rem;
   white-space: nowrap;
   box-shadow: 3px 3px 0px #000000;
   pointer-events: none;
   z-index: 1;
  }
  .chatbot-speech-bubble::after, .sabi-bible-speech-bubble::after {
   content: "";
   position: absolute;
   bottom: -20px;
   left: 50%;
   width: 0;
   height: 0;
   border: 10px solid transparent;
   border-top: 10px solid #ffffff;
   box-shadow: -1px -1px 0 1px #000000;
   transform: translateX(-50%);
  }
  .floating-watermarks {
   pointer-events: none;
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   overflow: hidden;
   z-index: 9999;
  }
  .watermark {
   position: absolute;
   font-size: clamp(1rem, 4vw, 2rem);
   color: rgba(255, 255, 255, 0.7);
   text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
   white-space: nowrap;
   opacity: 0.7;
  }
  @keyframes drift1 {
   0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
   50% { opacity: 1; }
   100% { transform: translate(200vw, 200vh) rotate(360deg); opacity: 0.7; }
  }
  @keyframes drift2 {
   0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
   50% { opacity: 1; }
   100% { transform: translate(-200vw, -200vh) rotate(-360deg); opacity: 0.7; }
  }
  @keyframes drift3 {
   0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
   50% { opacity: 1; }
   100% { transform: translate(200vw, -200vh) rotate(360deg); opacity: 0.7; }
  }
  @keyframes drift4 {
   0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
   50% { opacity: 1; }
   100% { transform: translate(-200vw, 200vh) rotate(-360deg); opacity: 0.7; }
  }
  .drift1 { animation: drift1 25s linear infinite; }
  .drift2 { animation: drift2 25s linear infinite; }
  .drift3 { animation: drift3 25s linear infinite; }
  .drift4 { animation: drift4 25s linear infinite; }
  .retry-button {
   background: #ff758c;
   color: white;
   padding: 0.5rem 1rem;
   border: none;
   border-radius: 5px;
   cursor: pointer;
   margin-top: 0.5rem;
   display: none;
  }
  .retry-button:hover { background: #ff4060; }
  .progress-bar {
   width: 90%;
   height: 5px;
   background: #555;
   margin: 0.5rem auto;
   border-radius: 5px;
   overflow: hidden;
   display: none;
  }
  .progress-bar div {
   height: 100%;
   background: #ff758c;
   width: 0%;
   transition: width 0.2s ease;
  }
  @media (max-width: 768px) {
   .sidebar { width: 100%; flex-direction: row; flex-wrap: wrap; justify-content: center; border-radius: 0; padding: 0.5rem; }
   .container { flex-direction: column; overflow-y: auto; padding-bottom: 10rem; }
   .content { padding-bottom: 15rem; }
   .music-player { bottom: calc(4rem + env(safe-area-inset-bottom)); }
  }
  @media (max-width: 480px) {
   .sidebar button { padding: 0.6rem; min-width: 60px; }
   .music-player { bottom: calc(6rem + env(safe-area-inset-bottom)); padding: 0.5rem; border-radius: 0; max-width: 90%; }
   .chatbot-bubble-container, .sabi-bible-bubble-container { bottom: calc(18rem + env(safe-area-inset-bottom)); }
   .container { overflow-y: scroll; height: auto; min-height: calc(100vh - 60px); padding-bottom: 12rem; }
  }
 </style>
</head>
<body>
 <div class="header">
  <span style="height: 40px; vertical-align: middle;">Welcome to Àríyò AI</span>
  <button class="share-button" aria-label="Share this page" onclick="shareContent()">
   <svg viewBox="0 0 24 24">
    <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"/>
   </svg>
  </button>
 </div>
 <div class="container">
  <div class="sidebar">
   <button onclick="openAlbumList()" aria-label="Choose an album">🎵 Choose An Album</button>
   <button onclick="openRadioList()" aria-label="Select radio stations">📻 Radio Stations</button>
   <button id="aboutBtn" aria-label="Learn more about Àríyò AI">ℹ️ About Àríyò AI</button>
  </div>
  <div class="content" id="main-content">
   <h2>Select an option from the sidebar</h2>
   <div id="newsContainer" class="news-container" style="display: none;"></div>
  </div>
 </div>
 <div class="music-player" aria-live="polite">
  <h3>Music Player</h3>
  <figure>
   <img id="albumCover" class="album-cover" src="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Kindness%20Cover%20Art.jpg" alt="Current album cover" />
   <figcaption id="trackInfo">A Very Good Bad Guy v3</figcaption>
  </figure>
  <div id="loadingSpinner" class="loading-spinner"></div>
  <div id="progressBar" class="progress-bar"><div></div></div>
  <p class="track-details" id="trackArtist">Artist: Omoluabi</p>
  <p class="track-details" id="trackYear">Release Year: 2025</p>
  <p class="track-duration" id="trackDuration">0:00 / 0:00</p>
  <p id="streakInfo" class="track-details">🔥 Current Streak: 0 days</p>
  <input type="range" id="seekBar" value="0" min="0" max="100" step="1" style="width: 90%; margin-top: 10px;" aria-label="Seek bar for audio playback" />
  <button id="retryButton" class="retry-button" onclick="retryTrack()">Retry</button>
  <button id="cacheButton" class="retry-button" onclick="cacheTrackForOffline(albums[currentAlbumIndex].tracks[currentTrackIndex].src)">Download for Offline</button>
  <div class="dropdown" role="button" aria-label="Choose a track" onclick="openTrackList()">🎵 Choose A Track</div>
  <div class="dropdown" role="button" aria-label="Choose a radio station" onclick="openRadioList()">📻 Radio Stations</div>
  <div class="music-controls icons-only">
   <button aria-label="Previous track" onclick="previousTrack()">⏮</button>
   <button aria-label="Play" onclick="playMusic()">▶</button>
   <button aria-label="Pause" onclick="pauseMusic()">⏸</button>
   <button aria-label="Stop" onclick="stopMusic()">⏹</button>
   <button aria-label="Next track" onclick="nextTrack()">⏭</button>
   <button aria-label="Toggle shuffle" onclick="toggleShuffle()">🔀</button>
  </div>
 </div>
 <div id="albumModal" class="modal" role="dialog" aria-labelledby="albumModalTitle" aria-describedby="albumModalDesc">
  <div class="modal-content">
   <span class="close" role="button" aria-label="Close album list" onclick="closeAlbumList()"></span>
   <h3 id="albumModalTitle">Choose An Album</h3>
   <p id="albumModalDesc" style="display: none;">Select an album to play.</p>
   <div class="album-list">
    <a href="#" onclick="selectAlbum(0)">Album 1: Kindness</a>
    <a href="#" onclick="selectAlbum(1)">Album 2: Street Sense</a>
   </div>
  </div>
 </div>
 <div id="trackModal" class="modal" role="dialog" aria-labelledby="trackModalTitle" aria-describedby="trackModalDesc">
  <div class="modal-content">
   <span class="close" role="button" aria-label="Close track list" onclick="closeTrackList()"></span>
   <h3 id="trackModalTitle">Choose A Track</h3>
   <p id="trackModalDesc" style="display: none;">Select a track to play.</p>
   <div class="track-list"></div>
  </div>
 </div>
 <div id="radioModal" class="modal" role="dialog" aria-labelledby="radioModalTitle" aria-describedby="radioModalDesc">
  <div class="modal-content">
   <span class="close" role="button" aria-label="Close radio list" onclick="closeRadioList()"></span>
   <h3 id="radioModalTitle">Choose A Radio Station</h3>
   <p id="radioModalDesc" style="display: none;">Select a radio station to listen to.</p>
   <div class="radio-list"></div>
  </div>
 </div>
 <div class="chatbot-bubble-container" role="button" aria-label="Open Chatbot" onclick="toggleChatbot()">
  <img src="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/chatbot.png" alt="Chatbot Icon" class="chatbot-float-icon" />
  <div class="chatbot-speech-bubble" id="chatbotBubble" aria-hidden="true">How far?</div>
 </div>
 <div class="chatbot-container" id="chatbotContainer">
  <button class="popup-close" role="button" aria-label="Close Chatbot" onclick="toggleChatbot()">×</button>
  <zapier-interfaces-chatbot-embed is-popup="false" chatbot-id="cm7s2oyu2000b3vmuwcwkj9kn" height="100%" width="100%" title="Àríyò AI Chatbot"></zapier-interfaces-chatbot-embed>
 </div>
 <div class="sabi-bible-bubble-container" role="button" aria-label="Open Sabi Bible" onclick="toggleSabiBible()">
  <img src="https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Sabi%20Bible.png" alt="Sabi Bible Icon" class="sabi-bible-float-icon" />
  <div class="sabi-bible-speech-bubble" id="sabiBibleBubble" aria-hidden="true">Sabi Bible dey here!</div>
 </div>
 <div class="sabi-bible-container" id="sabiBibleContainer">
  <button class="popup-close" role="button" aria-label="Close Sabi Bible" onclick="toggleSabiBible()">×</button>
  <zapier-interfaces-chatbot-embed is-popup="false" chatbot-id="cm7ve7fdl002jlclh8y1n6n1y" height="100%" width="100%" title="Sabi Bible Chatbot"></zapier-interfaces-chatbot-embed>
 </div>
 <div class="floating-watermarks">
  <div class="watermark drift1" style="top: 10%; left: 5%;">Omoluabi Productions</div>
  <div class="watermark drift2" style="top: 25%; left: 20%;">Omoluabi Productions</div>
  <div class="watermark drift3" style="top: 40%; left: 10%;">Omoluabi Productions</div>
  <div class="watermark drift4" style="top: 55%; left: 30%;">Omoluabi Productions</div>
  <div class="watermark drift1" style="top: 70%; left: 15%;">Omoluabi Productions</div>
  <div class="watermark drift2" style="top: 85%; left: 25%;">Omoluabi Productions</div>
  <div class="watermark drift3" style="top: 20%; left: 50%;">Omoluabi Productions</div>
  <div class="watermark drift4" style="top: 65%; left: 60%;">Omoluabi Productions</div>
  <div class="watermark drift1" style="top: 30%; left: 70%;">Omoluabi Productions</div>
  <div class="watermark drift2" style="top: 50%; left: 80%;">Omoluabi Productions</div>
  <div class="watermark drift3" style="top: 15%; left: 85%;">Omoluabi Productions</div>
  <div class="watermark drift4" style="top: 75%; left: 5%;">Omoluabi Productions</div>
 </div>
 <script>
  function shareContent() {
   if (navigator.share) {
    navigator.share({
     title: "Àríyò AI - Smart Naija AI",
     text: "Check out this awesome page!",
     url: window.location.href
    }).catch(err => console.error("Share failed:", err));
   } else {
    alert("Your browser doesn't support the Web Share API. Please copy the URL manually.");
   }
  }

  function openAboutPage() {
   window.location.href = 'about.html';
  }

  // Force refresh function to check for new version
  function forceRefresh() {
   const versionKey = 'siteVersion';
   const currentVersion = '1.0.1'; // Update this manually with each new release
   const storedVersion = localStorage.getItem(versionKey);
    
   if (storedVersion !== currentVersion) {
    caches.keys().then(keys => {
     Promise.all(keys.map(key => caches.delete(key)))
      .then(() => {
       localStorage.setItem(versionKey, currentVersion);
       window.location.reload(true); // Force reload from server
      });
    });
   }
  }

  const backgrounds = [
   'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Naija%20AI.jpg',
   'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Naija%20AI2.jpg',
   'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Naija%20AI3.jpg'
  ];
  let currentBgIndex = sessionStorage.getItem('bgIndex') ? parseInt(sessionStorage.getItem('bgIndex')) : 0;
  function setBackground() {
   document.body.style.backgroundImage = `url(${backgrounds[currentBgIndex]})`;
  }
  setBackground();
  const bgInterval = setInterval(() => {
   currentBgIndex = (currentBgIndex + 1) % backgrounds.length;
   sessionStorage.setItem('bgIndex', currentBgIndex);
   setBackground();
  }, 30000);

  const audioPlayer = new Audio();
  audioPlayer.id = 'audioPlayer';
  audioPlayer.preload = 'auto';
  document.body.appendChild(audioPlayer);
  const albumCover = document.getElementById('albumCover');
  const trackInfo = document.getElementById('trackInfo');
  const trackArtist = document.getElementById('trackArtist');
  const trackYear = document.getElementById('trackYear');
  const trackDuration = document.getElementById('trackDuration');
  const seekBar = document.getElementById('seekBar');
  const loadingSpinner = document.getElementById('loadingSpinner');
  const retryButton = document.getElementById('retryButton');
  const cacheButton = document.getElementById('cacheButton');
  const progressBar = document.getElementById('progressBar').querySelector('div');
  const streakInfo = document.getElementById('streakInfo');
  let shuffleMode = false;
  let isFirstPlay = true;
  let lastTrackSrc = '';
  let lastTrackTitle = '';
  let lastTrackIndex = 0;
  const albums = [
   {
    name: 'Kindness',
    cover: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Kindness%20Cover%20Art.jpg',
    tracks: [
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/A%20Very%20Good%20Bad%20Guy%20v3.mp3', title: 'A Very Good Bad Guy v3' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Dem%20Wan%20Shut%20Me%20Up.mp3', title: 'Dem Wan Shut Me Up' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/EFCC.mp3', title: 'EFCC' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Emergency.mp3', title: 'Emergency' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Film%20Trick%20Election.mp3', title: 'Film Trick Election' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Gbas%20Gbos.mp3', title: 'Gbas Gbos' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Kindness%20(Remastered).mp3', title: 'Kindness (Remastered)' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Locked%20Away.mp3', title: 'Locked Away' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Multi%20choice%20palava.mp3', title: 'Multi choice palava' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Na%20My%20Turn.mp3', title: 'Na My Turn' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ogoni%20Anthem%20(Remastered).mp3', title: 'Ogoni Anthem (Remastered)' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Ogoni%20Anthem.mp3', title: 'Ogoni Anthem' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Rich%20Pauper.mp3', title: 'Rich Pauper' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Senator%20Natasha’s%20Whisper.mp3', title: 'Senator Natasha’s Whisper' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Sharing%20Formula.mp3', title: 'Sharing Formula' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Show%20Of%20Shame%20v3%20(Remastered).mp3', title: 'Show Of Shame v3 (Remastered)' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Subsidy.mp3', title: 'Subsidy' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Vex%20Money.mp3', title: 'Vex Money' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Working%20on%20myself.mp3', title: 'Working on myself' }
    ]
   },
   {
    name: 'Street Sense',
    cover: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Street_Sense_Album_Cover.jpg',
    tracks: [
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Algorithm%20Of%20Life.mp3', title: 'Algorithm of life' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Babygirl.mp3', title: 'Babygirl' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Blood%20Money%20(Lithium).mp3', title: 'Blood Money (Lithium)' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/E%20Get%20Why.mp3', title: 'E Get Why' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Game%20Of%20Thrones.mp3', title: 'Game of Thrones' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Give%20and%20Take%20(Reciprocity%20in%20love).mp3', title: 'Give and Take (Reciprocity in love)' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Midas%20Touch.mp3', title: 'Midas Touch' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Naija%20Youth;%20Rise.mp3', title: 'Naija Youth, Rise' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Party%20No%20Go%20Stop.mp3', title: 'Party No Go Stop' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Pigeonhole%20Gbedu.mp3', title: 'Pigeonhole Gbedu' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Queen%20Warrior.mp3', title: 'Queen Warrior' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Sengemenge.mp3', title: 'Sengemenge' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Sowore.mp3', title: 'Sowore' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Street%20Sense.mp3', title: 'Street Sense' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/VDM.mp3', title: 'VDM' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/We%20Are%20Not%20Doing%20That.mp3', title: 'We Are Not Doing That' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Oil%20Money.mp3', title: 'Oil Money' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Gbamsolutely.mp3', title: 'Gbamsolutely' },
     { src: 'https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/Mic%20No%20Be%20For%20Waist.mp3', title: 'Mic No Be For Waist' }
    ]
   }
  ];

  const radioStations = [
   { name: "Nigeria Info FM", location: "Lagos", url: "https://nigeriainfofmlagos993-atunwadigital.streamguys1.com/nigeriainfofmlagos993", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Radio Lagos FM", location: "Lagos", url: "https://servoserver.com.ng/ekofmradiolagos/stream/2/live.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Vision FM", location: "Kaduna", url: "https://stream-172.zeno.fm/92mxpb1akhruv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiI5Mm14cGIxYWtocnV2IiwiaG9zdCI6InN0cmVhbS0xNzIuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6ImV5OWlMMlhEU1JLMHNyYnd0b3F4ckEiLCJpYXQiOjE3NDM5MTU4MzgsImV4cCI6MTc0MzkxNTg5OH0.5sHfe_ukTnT2Fdiy83NdYdU0da51JkZXBgFoJVhg8_I", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Wazobia FM", location: "Lagos", url: "https://wazobiafmlagos951-atunwadigital.streamguys1.com/wazobiafmlagos951", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Inspiration 92.3 FM", location: "Lagos", url: "https://inspiration923fm-atunwadigital.streamguys1.com/inspiration923fm", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Splash FM 105.5", location: "Ibadan", url: "http://edge.mixlr.com/channel/cfeki", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "The Beat 99.9 FM", location: "Lagos", url: "http://beatfmlagos.atunwadigital.streamguys1.com/beatfmlagos", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Fresh 107.9 FM", location: "Abeokuta", url: "https://stream-144.zeno.fm/7gs2681gqeruv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiI3Z3MyNjgxZ3FlcnV2IiwiaG9zdCI6InN0cmVhbS0xNDQuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6Im5nQmJkeTBjU3QtSlhMeG5QczVMUUEiLCJpYXQiOjE3NDM5MTMxNTksImV4cCI6MTc0MzkxMzIxOX0.bBtX4N1gdSrYDAPnoVAvA_OR42oPE3ceaGueOZW5dkg", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Faaji 106.5 FM", location: "Lagos", url: "http://streaming.faajifmradio.com:8000/faaji", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Jay 101.9 FM", location: "Jos", url: "http://live2.rcast.net:8970/;", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "FRCN Lagos Metro FM", location: "Abuja", url: "http://go.webgateready.com:7668/;", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Radio Nigeria", location: "Abuja", url: "https://stream.radionigeria.gov.ng/live", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "NBS Solid 97.1 FM", location: "Nassarawa", url: "https://nbsradio1.radioca.st/;", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Vision Africa Radio", location: "Abia", url: "https://xstreamer.galcom.org:8443/VisionAfrica", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Crest 106.1 FM", location: "Ondo", url: "https://stream-154.zeno.fm/9cgtkwg3teruv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiI5Y2d0a3dnM3RlcnV2IiwiaG9zdCI6InN0cmVhbS0xNTQuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6IlI4MXQzdjhRUWhDQWdkODRsaWJtckEiLCJpYXQiOjE3NDM5MTI3NzQsImV4cCI6MTc0MzkxMjgzNH0.QiIm090_iZfI55MZu7WqKjm5inX-mmKanKQgGBBbA7w", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Eko FM", location: "Lagos", url: "https://servoserver.com.ng/ekofmradiolagos/stream/1/live.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Liveway Radio Network FM", location: "Lagos", url: "https://stream-173.zeno.fm/qc43ktn6n0quv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiJxYzQza3RuNm4wcXV2IiwiaG9zdCI6InN0cmVhbS0xNzMuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6ImMtb0ZiQ3dtVE1hZUlEVU5YQ3BiVUEiLCJpYXQiOjE3NDM5MTMyODcsImV4cCI6MTc0MzkxMzM0N30.HVLieksgqvV_vsqRr9_rcDexkz6Lqeqeu7stKvuJr10", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Radio Space FM", location: "Ibadan", url: "https://stream-175.zeno.fm/79hmhafteg0uv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiI3OWhtaGFmdGVnMHV2IiwiaG9zdCI6InN0cmVhbS0xNzUuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6IkFqako3a0doUllPcVB1cmY3RDJmN2ciLCJpYXQiOjE3NDM5MTM0NzUsImV4cCI6MTc0MzkxMzUzNX0.Ow_YytmLcyURU6d_ji4EvQ-4YuLvJjXATerfWMHO67o", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Agidigbo 88.7 FM", location: "Ibadan", url: "https://agidigbostream.com.ng/radio/8000/radio.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "AKBC Akwa Ibom Radio", location: "Uyo", url: "https://stream-175.zeno.fm/2ttc8yl6giztv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiIydHRjOHlsNmdpenR2IiwiaG9zdCI6InN0cmVhbS0xNzUuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6IlE5VFpTRXpOUzFTMVlHSHdxaW5sQWciLCJpYXQiOjE3NDM5MTM3NjgsImV4cCI6MTc0MzkxMzgyOH0.9X5nRAtcN_4Pv-z5uE6ukYrNEIcwW0gHTVuYUlxVCj4", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "RFI Haoussa", location: "Nigeria", url: "https://rfihaoussa96k.ice.infomaniak.ch/rfihaoussa-96k.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Tungba FM", location: "Lagos", url: "https://stream-173.zeno.fm/3vd633m7ctzuv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiIzdmQ2MzNtN2N0enV2IiwiaG9zdCI6InN0cmVhbS0xNzMuemVuby5fbSIsInJ0dGwiOjUsImp0aSI6Im9QY19lN292UWFLdGUxSjFuNTI3M2ciLCJpYXQiOjE3NDM5MTQ0OTEsImV4cCI6MTc0MzkxNDU1MX0.UvA6Q0NuULFeRcHvqPJ9d68DeWz-0agoUBi8GDQWN0E", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "NPR News", location: "Washington DC", url: "https://npr-ice.streamguys1.com/live.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "BBC World Service", location: "London", url: "https://utulsa.streamguys1.com/KWGSHD3-MP3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Capital FM", location: "London", url: "https://media-ssl.musicradio.com/CapitalMP3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "WNYC", location: "New York", url: "https://fm939.wnyc.org/wnycfm-tunein", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "RTE Radio 1", location: "Dublin", url: "https://icecast.rte.ie/radio1", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Virgin Radio UK", location: "London", url: "https://radio.virginradio.co.uk/stream", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "WBEZ", location: "Chicago", url: "http://wbez.streamguys1.com/wbez128.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Joy FM", location: "Accra", url: "http://provisioning.streamtheworld.com/pls/JOY_FM.pls", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "UBC Radio", location: "Kampala", url: "https://stream.ubc.go.ug/ubcradio", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "Metro FM", location: "Johannesburg", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/METRO_FM.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" },
   { name: "947", location: "Johannesburg", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/FM947.mp3", logo: "https://raw.githubusercontent.com/Omoluabi1003/Ariyo-AI/main/logo.jpg" }
  ];
  let currentAlbumIndex = 0;
  let currentTrackIndex = 0;
  let currentRadioIndex = -1;

  function updateStreak() {
   const now = new Date();
   const today = now.toDateString();
   const streakData = JSON.parse(localStorage.getItem('ariyoStreak')) || { streak: 0, lastDate: null };
   if (streakData.lastDate !== today) {
    const lastDate = streakData.lastDate ? new Date(streakData.lastDate) : null;
    if (lastDate) {
     const diffTime = now - lastDate;
     const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
     if (diffDays === 1) streakData.streak += 1;
     else if (diffDays > 1) streakData.streak = 1;
    } else streakData.streak = 1;
    streakData.lastDate = today;
    localStorage.setItem('ariyoStreak', JSON.stringify(streakData));
   }
   streakInfo.textContent = `🔥 Current Streak: ${streakData.streak} days`;
  }

  function savePlayerState() {
   const playerState = {
    albumIndex: currentAlbumIndex,
    trackIndex: currentTrackIndex,
    radioIndex: currentRadioIndex,
    src: audioPlayer.src,
    playbackPosition: audioPlayer.currentTime,
    isPlaying: !audioPlayer.paused,
    shuffleMode: shuffleMode,
    timestamp: new Date().getTime()
   };
   sessionStorage.setItem('ariyoPlayerState', JSON.stringify(playerState));
  }

  function loadPlayerState() {
   const savedState = sessionStorage.getItem('ariyoPlayerState');
   if (savedState) {
    const playerState = JSON.parse(savedState);
    const ageInSeconds = (new Date().getTime() - playerState.timestamp) / 1000;
    if (ageInSeconds < 3600) return playerState; // Valid for 1 hour
   }
   return null;
  }

  function updateTrackListModal() {
   const trackListContainer = document.querySelector('.track-list');
   trackListContainer.innerHTML = '';
   albums[currentAlbumIndex].tracks.forEach((track, index) => {
    const trackLink = document.createElement('a');
    trackLink.href = '#';
    trackLink.onclick = () => selectTrack(track.src, track.title, index);
    trackLink.textContent = track.title;
    trackListContainer.appendChild(trackLink);
   });
  }

  function updateRadioListModal() {
   const radioListContainer = document.querySelector('.radio-list');
   radioListContainer.innerHTML = '';
   radioStations.forEach((station, index) => {
    const radioLink = document.createElement('a');
    radioLink.href = '#';
    radioLink.onclick = () => selectRadio(station.url, `${station.name} - ${station.location}`, index, station.logo);
    radioLink.textContent = `${station.name} (${station.location})`;
    radioListContainer.appendChild(radioLink);
   });
  }

  function updateMediaSession() {
   if ('mediaSession' in navigator) {
    navigator.mediaSession.metadata = new MediaMetadata({
     title: trackInfo.textContent,
     artist: currentRadioIndex >= 0 ? '' : 'Omoluabi',
     album: currentRadioIndex >= 0 ? '' : albums[currentAlbumIndex].name,
     artwork: [
      { src: albumCover.src, sizes: '512x512', type: 'image/jpeg' }
     ]
    });

    navigator.mediaSession.setActionHandler('play', playMusic);
    navigator.mediaSession.setActionHandler('pause', pauseMusic);
    navigator.mediaSession.setActionHandler('stop', stopMusic);
    navigator.mediaSession.setActionHandler('previoustrack', previousTrack);
    navigator.mediaSession.setActionHandler('nexttrack', nextTrack);

    if (currentRadioIndex === -1) {
     navigator.mediaSession.setActionHandler('seekto', (details) => {
      audioPlayer.currentTime = details.seekTime;
     });
    } else {
     navigator.mediaSession.setActionHandler('seekto', null);
    }
   }
  }

  function selectAlbum(albumIndex) {
   currentAlbumIndex = albumIndex;
   currentTrackIndex = 0;
   currentRadioIndex = -1;
   albumCover.src = albums[currentAlbumIndex].cover;
   loadTrack(albums[currentAlbumIndex].tracks[currentTrackIndex].src, albums[currentAlbumIndex].tracks[currentTrackIndex].title, currentTrackIndex);
   updateTrackListModal();
   closeAlbumList();
   savePlayerState();
  }

  function loadTrack(src, title, index) {
   currentTrackIndex = index;
   currentRadioIndex = -1;
   audioPlayer.src = src;
   audioPlayer.currentTime = 0;
   trackInfo.textContent = title;
   trackArtist.textContent = 'Artist: Omoluabi';
   trackYear.textContent = 'Release Year: 2025';
   stopMusic();
   loadingSpinner.style.display = 'block';
   albumCover.style.display = 'none';
   retryButton.style.display = 'none';
   cacheButton.style.display = 'block';
   document.getElementById('progressBar').style.display = 'block';
   progressBar.style.width = '0%';
   trackDuration.textContent = '0:00 / 0:00';
  }

  function selectTrack(src, title, index) {
   currentTrackIndex = index;
   currentRadioIndex = -1;
   lastTrackSrc = src;
   lastTrackTitle = title;
   lastTrackIndex = index;
   audioPlayer.src = src + '?t=' + new Date().getTime();
   audioPlayer.currentTime = 0;
   trackInfo.textContent = title;
   trackArtist.textContent = 'Artist: Omoluabi';
   trackYear.textContent = 'Release Year: 2025';
   closeTrackList();
   stopMusic();
   loadingSpinner.style.display = 'block';
   albumCover.style.display = 'none';
   retryButton.style.display = 'none';
   cacheButton.style.display = 'block';
   document.getElementById('progressBar').style.display = 'block';
   progressBar.style.width = '0%';
   trackDuration.textContent = '0:00 / 0:00';
   handleAudioLoad(src, title);
   updateMediaSession();
  }

  function selectRadio(src, title, index, logo) {
   currentRadioIndex = index;
   currentTrackIndex = -1;
   lastTrackSrc = src;
   lastTrackTitle = title;
   lastTrackIndex = index;
   audioPlayer.src = src;
   audioPlayer.currentTime = 0;
   trackInfo.textContent = title;
   trackArtist.textContent = '';
   trackYear.textContent = '';
   albumCover.src = logo;
   closeRadioList();
   stopMusic();
   loadingSpinner.style.display = 'block';
   albumCover.style.display = 'none';
   retryButton.style.display = 'none';
   cacheButton.style.display = 'none';
   document.getElementById('progressBar').style.display = 'block';
   progressBar.style.width = '0%';
   trackDuration.textContent = 'Live';
   handleAudioLoad(src, title);
   updateMediaSession();
  }

  function retryTrack() {
   if (currentRadioIndex >= 0) selectRadio(lastTrackSrc, lastTrackTitle, lastTrackIndex, radioStations[currentRadioIndex].logo);
   else selectTrack(lastTrackSrc, lastTrackTitle, lastTrackIndex);
  }

  function handleAudioLoad(src, title) {
   const playTimeout = setTimeout(() => {
    loadingSpinner.style.display = 'none';
    albumCover.style.display = 'block';
    document.getElementById('progressBar').style.display = 'none';
    trackInfo.textContent = 'Error: Stream failed to load (timeout)';
    retryButton.style.display = 'block';
   }, 4000);

   audioPlayer.addEventListener('progress', () => {
    if (audioPlayer.buffered.length > 0 && audioPlayer.duration && currentRadioIndex === -1) {
     const bufferedEnd = audioPlayer.buffered.end(0);
     const duration = audioPlayer.duration;
     progressBar.style.width = `${(bufferedEnd / duration) * 100}%`;
    }
   });

   audioPlayer.addEventListener('canplay', () => {
    clearTimeout(playTimeout);
    loadingSpinner.style.display = 'none';
    albumCover.style.display = 'block';
    if (isFirstPlay) {
     isFirstPlay = false;
    } else {
     playMusic();
    }
   }, { once: true });

   audioPlayer.addEventListener('timeupdate', () => {
    if (currentRadioIndex === -1) {
     if (audioPlayer.duration && !isNaN(audioPlayer.duration)) {
      const currentTime = audioPlayer.currentTime;
      const duration = audioPlayer.duration;
      seekBar.value = (currentTime / duration) * 100;
      trackDuration.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
     }
    } else {
     trackDuration.textContent = 'Live';
     seekBar.value = 0; // Reset seek bar for live streams
    }
   });

   audioPlayer.addEventListener('error', () => {
    clearTimeout(playTimeout);
    loadingSpinner.style.display = 'none';
    albumCover.style.display = 'block';
    document.getElementById('progressBar').style.display = 'none';
    trackInfo.textContent = 'Error: Stream failed to load';
    retryButton.style.display = 'block';
   }, { once: true });
  }

  function formatTime(seconds) {
   if (isNaN(seconds)) return '0:00';
   const minutes = Math.floor(seconds / 60);
   const secs = Math.floor(seconds % 60);
   return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
  }

  function playMusic() {
   audioPlayer.play();
   albumCover.classList.add('spin');
   updateStreak();
   savePlayerState();
   if ('mediaSession' in navigator) {
    navigator.mediaSession.playbackState = 'playing';
   }
  }

  function pauseMusic() {
   audioPlayer.pause();
   albumCover.classList.remove('spin');
   savePlayerState();
   if ('mediaSession' in navigator) {
    navigator.mediaSession.playbackState = 'paused';
   }
  }

  function stopMusic() {
   audioPlayer.pause();
   audioPlayer.currentTime = 0;
   albumCover.classList.remove('spin');
   savePlayerState();
   if ('mediaSession' in navigator) {
    navigator.mediaSession.playbackState = 'paused';
   }
  }

  function nextTrack() {
   if (currentRadioIndex >= 0) {
    currentRadioIndex = (currentRadioIndex + 1) % radioStations.length;
    selectRadio(radioStations[currentRadioIndex].url, `${radioStations[currentRadioIndex].name} - ${radioStations[currentRadioIndex].location}`, currentRadioIndex, radioStations[currentRadioIndex].logo);
   } else {
    if (shuffleMode) {
     currentTrackIndex = Math.floor(Math.random() * albums[currentAlbumIndex].tracks.length);
    } else {
     currentTrackIndex = (currentTrackIndex + 1) % albums[currentAlbumIndex].tracks.length;
    }
    selectTrack(albums[currentAlbumIndex].tracks[currentTrackIndex].src, albums[currentAlbumIndex].tracks[currentTrackIndex].title, currentTrackIndex);
   }
  }

  function previousTrack() {
   if (currentRadioIndex >= 0) {
    currentRadioIndex = (currentRadioIndex - 1 + radioStations.length) % radioStations.length;
    selectRadio(radioStations[currentRadioIndex].url, `${radioStations[currentRadioIndex].name} - ${radioStations[currentRadioIndex].location}`, currentRadioIndex, radioStations[currentRadioIndex].logo);
   } else {
    currentTrackIndex = (currentTrackIndex - 1 + albums[currentAlbumIndex].tracks.length) % albums[currentAlbumIndex].tracks.length;
    selectTrack(albums[currentAlbumIndex].tracks[currentTrackIndex].src, albums[currentAlbumIndex].tracks[currentTrackIndex].title, currentTrackIndex);
   }
  }

  function toggleShuffle() {
   shuffleMode = !shuffleMode;
   savePlayerState();
  }

  function cacheTrackForOffline(src) {
   if ('caches' in window) {
    caches.open('ariyo-audio-cache').then(cache => {
     cache.add(src).then(() => {
      console.log(`Cached ${src} for offline use`);
      alert('Track cached for offline use!');
     }).catch(err => console.error('Caching failed:', err));
    });
   } else {
    alert('Your browser does not support offline caching.');
   }
  }

  function openAlbumList() {
   document.getElementById('albumModal').style.display = 'block';
  }

  function closeAlbumList() {
   document.getElementById('albumModal').style.display = 'none';
  }

  function openTrackList() {
   updateTrackListModal();
   document.getElementById('trackModal').style.display = 'block';
  }

  function closeTrackList() {
   document.getElementById('trackModal').style.display = 'none';
  }

  function openRadioList() {
   updateRadioListModal();
   document.getElementById('radioModal').style.display = 'block';
  }

  function closeRadioList() {
   document.getElementById('radioModal').style.display = 'none';
  }

  function toggleChatbot() {
   const chatbotContainer = document.getElementById('chatbotContainer');
   chatbotContainer.classList.toggle('active');
  }

  function toggleSabiBible() {
   const sabiBibleContainer = document.getElementById('sabiBibleContainer');
   sabiBibleContainer.classList.toggle('active');
  }
  seekBar.addEventListener('input', () => {
   if (currentRadioIndex === -1 && audioPlayer.duration && !isNaN(audioPlayer.duration)) {
    const seekTime = (seekBar.value / 100) * audioPlayer.duration;
    audioPlayer.currentTime = seekTime;
   }
  });

  // Initialize
  document.getElementById('aboutBtn').addEventListener('click', openAboutPage);
  updateStreak();
  forceRefresh(); // Check for new version on load
  const playerState = loadPlayerState();
  if (playerState) {
   currentAlbumIndex = playerState.albumIndex;
   currentTrackIndex = playerState.trackIndex;
   currentRadioIndex = playerState.radioIndex;
   shuffleMode = playerState.shuffleMode;
   if (currentRadioIndex >= 0) {
    selectRadio(radioStations[currentRadioIndex].url, `${radioStations[currentRadioIndex].name} - ${radioStations[currentRadioIndex].location}`, currentRadioIndex, radioStations[currentRadioIndex].logo);
   } else {
    selectTrack(albums[currentAlbumIndex].tracks[currentTrackIndex].src, albums[currentAlbumIndex].tracks[currentTrackIndex].title, currentTrackIndex);
   }
   audioPlayer.currentTime = playerState.playbackPosition;
   if (playerState.isPlaying) playMusic();
  }
 </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92d605cd8b6832fb',t:'MTc0NDE1OTk1Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
